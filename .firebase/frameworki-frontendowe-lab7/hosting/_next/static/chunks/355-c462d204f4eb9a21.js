"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[355],{8279:(e,r,t)=>{t.r(r),t.d(r,{default:()=>d});var o=t(5155),a=t(2115),l=t(7058),i=t(1746),n=t(7396),s=t(2950);function d(e){let{gameId:r,initialState:t}=e,d=(0,a.useRef)(r||crypto.randomUUID()),[c,m]=(0,a.useState)({boardSize:3,backgroundColor:"#ffffff",symbolColors:{X:"#ff0000",O:"#0000ff"},borderColor:"#000000",cellSize:80,symbolSize:"2rem",gameMode:"friend",playerSymbol:"X"}),[u,f]=(0,a.useState)(Array(9).fill(null)),[b,p]=(0,a.useState)(!0),[y,h]=(0,a.useState)({xMoves:0,oMoves:0,emptyFields:9}),[g,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(!i.j.currentUser)return;let e=(0,l.H9)(i.db,"users",i.j.currentUser.uid,"settings","tictactoe"),o=await (0,l.x7)(e);if(o.exists()){let e=o.data();if(m(e),!t&&!r&&(f(Array(e.boardSize*e.boardSize).fill(null)),h(r=>({...r,emptyFields:e.boardSize*e.boardSize})),"friend"!==e.gameMode&&"O"===e.playerSymbol)){let r=Array(e.boardSize*e.boardSize).fill(null),t=M(r,e.gameMode);null!==t&&(r[t]="X",f(r),h(e=>({...e,xMoves:1,emptyFields:e.emptyFields-1})))}}t&&(f(t.currentBoard),p(t.xIsNext),h({xMoves:t.xMoves,oMoves:t.oMoves,emptyFields:t.emptyFields}),m(e=>({...e,boardSize:t.boardSize,gameMode:t.gameMode||"friend",playerSymbol:t.playerSymbol||"X"})))})()},[i.j.currentUser,i.db,t,r]);let x=e=>e.reduce((e,r,t)=>(r||e.push(t),e),[]),S=(e,r)=>{for(let t of x(e)){let o=[...e];if(o[t]=r,j(o)===r)return t}return null},M=(e,r)=>{let t=x(e);if(0===t.length)return null;let o=S(e,"X"===c.playerSymbol?"O":"X");if(null!==o)return o;let a=S(e,c.playerSymbol);if(null!==a)return a;switch(r){case"easy":default:return t[Math.floor(Math.random()*t.length)];case"medium":{if(.7>Math.random())return t[Math.floor(Math.random()*t.length)];let r=Math.floor(e.length/2),o=Math.sqrt(e.length),a=[r,0,o-1,o*(o-1),o*o-1].filter(e=>t.includes(e));return a.length>0?a[Math.floor(Math.random()*a.length)]:t[Math.floor(Math.random()*t.length)]}case"hard":{let r=Math.floor(e.length/2),o=Math.sqrt(e.length);if(t.includes(r))return r;let a=[0,o-1,o*(o-1),o*o-1].filter(e=>t.includes(e));if(a.length>0)return a[Math.floor(Math.random()*a.length)];return t[Math.floor(Math.random()*t.length)]}}},j=e=>{for(let r=0;r<c.boardSize;r++)for(let t=0;t<=c.boardSize-c.boardSize;t++){let t=e.slice(r*c.boardSize,(r+1)*c.boardSize);if(t.every(e=>"X"===e)||t.every(e=>"O"===e))return t[0]}for(let r=0;r<c.boardSize;r++){let t=[];for(let o=0;o<c.boardSize;o++)t.push(e[r+o*c.boardSize]);if(t.every(e=>"X"===e)||t.every(e=>"O"===e))return t[0]}let r=[],t=[];for(let o=0;o<c.boardSize;o++)r.push(e[o*c.boardSize+o]),t.push(e[o*c.boardSize+(c.boardSize-1-o)]);return r.every(e=>"X"===e)||r.every(e=>"O"===e)?r[0]:t.every(e=>"X"===e)||t.every(e=>"O"===e)?t[0]:null},O=async e=>{if(j(u)||u[e])return;let r=[...u],t=c.playerSymbol||"X",o="X"===t?"O":"X";r[e]=t;let a={xMoves:y.xMoves+("X"===t?1:0),oMoves:y.oMoves+("O"===t?1:0),emptyFields:y.emptyFields-1};if(f(r),h(a),"friend"!==c.gameMode&&!j(r)&&a.emptyFields>0){let e=M(r,c.gameMode);null!==e&&(r[e]=o,a["X"===o?"xMoves":"oMoves"]+=1,a.emptyFields-=1,f(r),h(a))}else p(!b);let n=j(r),s={timestamp:(0,l.O5)(),lastModified:(0,l.O5)(),status:n||0===a.emptyFields?"completed":"in_progress",winner:n||(0===a.emptyFields?"Draw":null),xMoves:a.xMoves,oMoves:a.oMoves,boardSize:c.boardSize,currentBoard:r,xIsNext:"friend"!==c.gameMode||!b,emptyFields:a.emptyFields,gameMode:c.gameMode,playerSymbol:c.playerSymbol};try{await (0,l.BN)((0,l.H9)(i.db,"users",i.j.currentUser.uid,"tictactoe-games",d.current),s)}catch(e){console.error("Error saving game:",e)}},z=j(u),w=z?"Winner: ".concat(z):0===y.emptyFields?"Game is a draw!":"Next player: ".concat(b?"X":"O");return(0,o.jsxs)("div",{className:"flex min-h-screen flex-col items-center justify-center p-4",children:[(0,o.jsxs)("h1",{className:"text-3xl font-bold mb-8",children:["Tic Tac Toe ",c.boardSize,"x",c.boardSize,"friend"!==c.gameMode&&" (vs Bot - ".concat(c.gameMode,")")]}),"friend"!==c.gameMode&&(0,o.jsxs)("p",{className:"mb-4 text-lg",children:["You are playing as:"," ",(null==g?void 0:g.playerSymbol)||c.playerSymbol||"X"]}),(0,o.jsxs)("div",{className:"mb-4 flex items-center justify-center gap-3",children:[(0,o.jsxs)(n.default,{href:"/tic-tac-toe/settings",className:"rounded-md bg-primary px-4 py-3 text-base text-white font-medium dark:text-white hover:bg-primary/90 flex items-center gap-2",children:[(0,o.jsx)(s.xPd,{size:25}),"Settings"]}),(0,o.jsxs)(n.default,{href:"/tic-tac-toe/history",className:"rounded-md bg-primary px-4 py-3 text-base text-white font-medium dark:text-white hover:bg-primary/90 flex items-center gap-2",children:[(0,o.jsx)(s.Eyn,{size:25}),"History"]})]}),(0,o.jsxs)("div",{className:"mb-4",children:[(0,o.jsxs)("p",{children:["X Moves: ",y.xMoves]}),(0,o.jsxs)("p",{children:["O Moves: ",y.oMoves]}),(0,o.jsxs)("p",{children:["Empty Fields: ",y.emptyFields]}),(0,o.jsx)("p",{className:"font-bold",children:w})]}),(0,o.jsx)("div",{className:"grid gap-1 mb-4",style:{gridTemplateColumns:"repeat(".concat(c.boardSize,", ").concat(c.cellSize,"px)")},children:u.map((e,r)=>(0,o.jsx)("button",{onClick:()=>O(r),style:{width:"".concat(c.cellSize,"px"),height:"".concat(c.cellSize,"px"),backgroundColor:c.backgroundColor,borderColor:c.borderColor,color:e?c.symbolColors[e]:"inherit",fontSize:c.symbolSize},className:"border-2 flex items-center justify-center font-bold hover:bg-gray-100",disabled:!!(z||e),children:e},r))}),(0,o.jsx)("div",{className:"space-x-4",children:(0,o.jsx)("button",{className:"rounded-md bg-primary px-4 py-3 text-base text-white font-medium dark:text-white hover:bg-primary/90 flex items-center gap-2",onClick:()=>{f(Array(c.boardSize*c.boardSize).fill(null)),p(!0),h({xMoves:0,oMoves:0,emptyFields:c.boardSize*c.boardSize})},children:"Reset Game"})})]})}},1746:(e,r,t)=>{t.d(r,{db:()=>s,j:()=>n});var o=t(9904),a=t(4565),l=t(7058);let i=(0,o.Wp)({apiKey:"AIzaSyCiJP0ScJF7oJxWzdwDIavBwcyQBOPmPHU",authDomain:"frameworki-frontendowe-lab7.firebaseapp.com",projectId:"frameworki-frontendowe-lab7",storageBucket:"frameworki-frontendowe-lab7.firebasestorage.app",messagingSenderId:"799442264799",appId:"1:799442264799:web:1dc0bdc2d770f93086bf6a",measurementId:"G-QF0X6SVX1R"}),n=(0,a.xI)(i),s=(0,l.aU)(i)},7396:(e,r,t)=>{t.d(r,{default:()=>a.a});var o=t(4839),a=t.n(o)},3435:(e,r,t)=>{t.d(r,{k5:()=>c});var o=t(2115),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=o.createContext&&o.createContext(a),i=["attr","size","title"];function n(){return(n=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,o)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach(function(r){var o,a;o=r,a=t[r],(o=function(e){var r=function(e,r){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,r||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:r+""}(o))in e?Object.defineProperty(e,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[o]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function c(e){return r=>o.createElement(m,n({attr:d({},e.attr)},r),function e(r){return r&&r.map((r,t)=>o.createElement(r.tag,d({key:t},r.attr),e(r.child)))}(e.child))}function m(e){var r=r=>{var t,{attr:a,size:l,title:s}=e,c=function(e,r){if(null==e)return{};var t,o,a=function(e,r){if(null==e)return{};var t={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(r.indexOf(o)>=0)continue;t[o]=e[o]}return t}(e,r);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)t=l[o],!(r.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}(e,i),m=l||r.size||"1em";return r.className&&(t=r.className),e.className&&(t=(t?t+" ":"")+e.className),o.createElement("svg",n({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,c,{className:t,style:d(d({color:e.color||r.color},r.style),e.style),height:m,width:m,xmlns:"http://www.w3.org/2000/svg"}),s&&o.createElement("title",null,s),e.children)};return void 0!==l?o.createElement(l.Consumer,null,e=>r(e)):r(a)}}}]);